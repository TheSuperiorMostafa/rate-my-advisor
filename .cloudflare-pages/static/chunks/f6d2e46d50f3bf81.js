(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75165,e=>{"use strict";var s=e.i(43476),t=e.i(71645);function r({activeTab:e,onTabChange:t}){return(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"pending",label:"Pending",count:null},{id:"approved",label:"Approved",count:null},{id:"rejected",label:"Rejected",count:null},{id:"reports",label:"Reports",count:null}].map(r=>(0,s.jsxs)("button",{onClick:()=>t(r.id),className:`
              py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap
              ${e===r.id?"border-[#A78BFA] text-[#5B2D8B]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
            `,children:[r.label,null!==r.count&&(0,s.jsx)("span",{className:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs",children:r.count})]},r.id))})})}var a=e.i(22016),i=e.i(19455),n=e.i(96640),l=e.i(75157);function o({tags:e,className:t,size:r="md"}){return 0===e.length?null:(0,s.jsx)("div",{className:(0,l.cn)("flex flex-wrap gap-2",t),children:e.map(e=>(0,s.jsx)(n.Badge,{variant:"info",size:r,children:e.name},e.id))})}let d={in_person:"In-Person",virtual:"Virtual",email:"Email",mixed:"Mixed"},c={last_6_months:"Last 6 months","6_12_months":"6-12 months ago","1_2_years":"1-2 years ago","2_plus_years":"2+ years ago"};function m({review:e,onAction:r,showReports:n}){let[l,m]=(0,t.useState)(!1),[x,p]=(0,t.useState)(""),[h,u]=(0,t.useState)(!1),g=Object.values(e.ratings).reduce((e,s)=>e+s,0)/Object.values(e.ratings).length;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Review for ",e.advisor.name]}),e.isVerified&&(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"✓ Verified Student"}),e.reportCount&&e.reportCount>0&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800",children:[e.reportCount," ",1===e.reportCount?"report":"reports"]})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[e.advisor.department," • ",e.advisor.university]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Submitted: ",new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),(0,s.jsx)(a.default,{href:`/a/${e.advisor.id}${e.advisor.slug?`/${e.advisor.slug}`:""}`,className:"text-sm text-[#5B2D8B] hover:text-[#4A2375] underline",target:"_blank",rel:"noopener noreferrer",children:"View Advisor Page →"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Overall Rating:"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(e=>(0,s.jsx)("span",{className:`text-lg ${e<=Math.round(g)?"text-yellow-400":"text-gray-300"}`,children:"★"},e)),(0,s.jsxs)("span",{className:"ml-2 text-sm font-medium text-gray-700",children:[g.toFixed(1)," / 5.0"]})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-xs text-gray-600",children:Object.entries(e.ratings).map(([e,t])=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{className:"capitalize",children:[e,":"]})," ",(0,s.jsxs)("span",{className:"font-medium",children:[t,"/5"]})]},e))})]}),(0,s.jsx)("div",{className:"mb-4 p-4 bg-gray-50 rounded-md",children:(0,s.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:e.text})}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-4",children:[(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Meeting:"})," ",d[e.meetingType]||e.meetingType]}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Timeframe:"})," ",c[e.timeframe]||e.timeframe]}),e.tags.length>0&&(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(o,{tags:e.tags.map(e=>({id:e,name:e,slug:e.toLowerCase().replace(/\s+/g,"-")}))})})]}),(0,s.jsx)("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Button,{onClick:()=>{u(!0),r(e.id,"keep"),u(!1)},disabled:h,variant:"outline",size:"sm",children:"Keep Review"}),(0,s.jsx)(i.Button,{onClick:()=>m(!0),disabled:h,variant:"outline",size:"sm",className:"border-yellow-300 text-yellow-700 hover:bg-yellow-50",children:"Re-Review"}),(0,s.jsx)(i.Button,{onClick:()=>{confirm("Are you sure you want to remove this review? This action cannot be undone.")&&(u(!0),r(e.id,"remove"),u(!1))},disabled:h,size:"sm",className:"bg-red-600 hover:bg-red-700",children:"Remove Review"})]}):"pending"===e.status?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Button,{onClick:()=>{u(!0),r(e.id,"approve"),u(!1)},disabled:h,size:"sm",className:"bg-green-600 hover:bg-green-700",children:"Approve"}),(0,s.jsx)(i.Button,{onClick:()=>m(!0),disabled:h,variant:"outline",size:"sm",className:"border-red-300 text-red-700 hover:bg-red-50",children:"Reject"})]}):(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Status: ",(0,s.jsx)("span",{className:"font-medium capitalize",children:e.status})]})})]}),l&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Review"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this review. This reason is for internal use only and will not be shown to the user."}),(0,s.jsx)("textarea",{value:x,onChange:e=>p(e.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#A78BFA] mb-4"}),(0,s.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,s.jsx)(i.Button,{onClick:()=>{m(!1),p("")},variant:"outline",size:"sm",disabled:h,children:"Cancel"}),(0,s.jsx)(i.Button,{onClick:()=>{x.trim()?(u(!0),r(e.id,"reject",x),m(!1),p(""),u(!1)):alert("Please provide a rejection reason")},size:"sm",className:"bg-red-600 hover:bg-red-700",disabled:h||!x.trim(),children:h?"Processing...":"Reject Review"})]})]})})]})}function x({size:e="md"}){return(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[e]} border-4 border-violet-200 border-t-[#5B2D8B] rounded-full animate-spin`})})}function p({title:e,description:t,action:r}){return(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:e}),t&&(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:t}),r&&(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)("button",{onClick:r.onClick,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-[#5B2D8B] hover:bg-[#5B2D8B] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#A78BFA]",children:r.label})})]})}function h(){let[e,a]=(0,t.useState)("pending"),[i,n]=(0,t.useState)([]),[l,o]=(0,t.useState)(!0),[d,c]=(0,t.useState)(""),h=async e=>{o(!0),c("");try{let s=await fetch(`/api/mod/reviews?status=${"reports"===e?"reported":e}&limit=50`),t=await s.json();if(!s.ok)throw Error(t.error||"Failed to fetch reviews");n(t.data?.reviews||[])}catch(e){c(e instanceof Error?e.message:"Failed to load reviews")}finally{o(!1)}};(0,t.useEffect)(()=>{h(e)},[e]);let u=async(s,t,r)=>{try{if("approve"===t){if(!(await fetch(`/api/mod/reviews/${s}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).ok)throw Error("Failed to approve review")}else if("reject"===t){if(!r)return void alert("Please provide a rejection reason");if(!(await fetch(`/api/mod/reviews/${s}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:r,notes:""})})).ok)throw Error("Failed to reject review")}else if("remove"===t){if(!(await fetch(`/api/mod/reviews/${s}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:"Removed due to reports",notes:""})})).ok)throw Error("Failed to remove review")}else if("keep"===t&&!(await fetch("/api/mod/reports/resolve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewId:s,action:"dismiss"})})).ok)throw Error("Failed to resolve reports");await h(e)}catch(e){alert(e instanceof Error?e.message:"Action failed")}};return(0,s.jsxs)("div",{children:[(0,s.jsx)(r,{activeTab:e,onTabChange:a}),l?(0,s.jsx)("div",{className:"flex justify-center py-12",children:(0,s.jsx)(x,{size:"lg"})}):d?(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,s.jsx)("p",{className:"text-red-800",children:d})}):0===i.length?(0,s.jsx)(p,{title:`No ${e} reviews`,description:"pending"===e?"All reviews have been moderated":"reports"===e?"No reported reviews":`No ${e} reviews found`}):(0,s.jsx)("div",{className:"space-y-4 mt-6",children:i.map(t=>(0,s.jsx)(m,{review:t,onAction:u,showReports:"reports"===e},t.id))})]})}e.s(["ModerationDashboard",()=>h],75165)}]);