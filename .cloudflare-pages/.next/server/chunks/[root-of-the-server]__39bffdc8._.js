module.exports=[24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},63021,(e,t,r)=>{t.exports=e.x("@prisma/client-2c3a283f134fdcb6",()=>require("@prisma/client-2c3a283f134fdcb6"))},98043,e=>{"use strict";var t=e.i(63021);let r=globalThis.prisma??new t.PrismaClient({log:["error"]});e.s(["prisma",0,r])},48855,89104,e=>{"use strict";var t=e.i(89171);function r(e,s=200){return t.NextResponse.json({success:!0,data:e},{status:s})}function s(e,r=400,n){return t.NextResponse.json({success:!1,error:e,...n&&{errors:n}},{status:r})}function n(e="Resource not found"){return s(e,404)}function i(e="Unauthorized"){return s(e,401)}function a(e){return t.NextResponse.json({success:!1,error:"Rate limit exceeded",resetAt:new Date(e).toISOString()},{status:429,headers:{"Retry-After":Math.ceil((e-Date.now())/1e3).toString()}})}e.s(["errorResponse",()=>s,"notFoundResponse",()=>n,"rateLimitResponse",()=>a,"successResponse",()=>r,"unauthorizedResponse",()=>i],48855);let o={};function u(e,t){let r=t.keyPrefix?`${t.keyPrefix}:${e}`:e,s=Date.now(),n=o[r];return!n||n.resetAt<s?(n={count:1,resetAt:s+t.windowMs},o[r]=n,{allowed:!0,remaining:t.maxRequests-1,resetAt:n.resetAt}):(n.count++,n.count>t.maxRequests)?{allowed:!1,remaining:0,resetAt:n.resetAt}:{allowed:!0,remaining:t.maxRequests-n.count,resetAt:n.resetAt}}function l(e,t){let r=u(e.headers.get("x-forwarded-for")?.split(",")[0]||"unknown",t);return r.allowed?null:new Response(JSON.stringify({error:"Rate limit exceeded",resetAt:new Date(r.resetAt).toISOString()}),{status:429,headers:{"Content-Type":"application/json","X-RateLimit-Limit":t.maxRequests.toString(),"X-RateLimit-Remaining":r.remaining.toString(),"X-RateLimit-Reset":r.resetAt.toString(),"Retry-After":Math.ceil((r.resetAt-Date.now())/1e3).toString()}})}setInterval(()=>{let e=Date.now();Object.keys(o).forEach(t=>{o[t].resetAt<e&&delete o[t]})},3e5),e.s(["checkRateLimit",()=>u,"rateLimitMiddleware",()=>l],89104)},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},54603,e=>{"use strict";e.i(25944),e.s([])},79832,e=>{"use strict";e.i(54603);var t=e.i(25944),r=e.i(98043);async function s(e){let r=await (0,t.getToken)({req:e,secret:process.env.NEXTAUTH_SECRET});return r?.sub||null}async function n(e){if(!e)return null;let s=await (0,t.getToken)({req:e,secret:process.env.NEXTAUTH_SECRET});if(!s?.sub)return null;let n=await r.prisma.user.findUnique({where:{id:s.sub},select:{id:!0,email:!0,name:!0,role:!0,eduVerified:!0}});return n?{user:{id:n.id,email:n.email,name:n.name,role:n.role,eduVerified:n.eduVerified}}:null}async function i(e){let r=await (0,t.getToken)({req:e,secret:process.env.NEXTAUTH_SECRET});return r?.role==="ADMIN"}async function a(){let{headers:t}=await e.A(6878),s=await t(),{getToken:n}=await e.A(21712),i=await n({req:{headers:Object.fromEntries(s.entries())},secret:process.env.NEXTAUTH_SECRET});if(!i?.sub)return null;let a=await r.prisma.user.findUnique({where:{id:i.sub},select:{id:!0,email:!0,name:!0,role:!0,eduVerified:!0}});return a?{user:{id:a.id,email:a.email,name:a.name,role:a.role,eduVerified:a.eduVerified}}:null}function o(e){let t=e.headers.get("x-forwarded-for");if(t)return t.split(",")[0].trim();let r=e.headers.get("x-real-ip");return r||"unknown"}e.s(["getClientIP",()=>o,"getServerSession",()=>a,"getSession",()=>n,"getUserId",()=>s,"isAdmin",()=>i])},6878,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_next_f5199d09._.js"].map(t=>e.l(t))).then(()=>t(93458)))},21712,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_next-auth_jwt_9ac8b283.js"].map(t=>e.l(t))).then(()=>t(28833)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__39bffdc8._.js.map