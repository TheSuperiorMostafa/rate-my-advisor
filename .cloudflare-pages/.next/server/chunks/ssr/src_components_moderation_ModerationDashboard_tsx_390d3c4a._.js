module.exports=[19973,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({activeTab:a,onTabChange:c}){return(0,b.jsx)("div",{className:"border-b border-gray-200",children:(0,b.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"pending",label:"Pending",count:null},{id:"approved",label:"Approved",count:null},{id:"rejected",label:"Rejected",count:null},{id:"reports",label:"Reports",count:null}].map(d=>(0,b.jsxs)("button",{onClick:()=>c(d.id),className:`
              py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap
              ${a===d.id?"border-[#A78BFA] text-[#5B2D8B]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
            `,children:[d.label,null!==d.count&&(0,b.jsx)("span",{className:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs",children:d.count})]},d.id))})})}var e=a.i(38246),f=a.i(99570),g=a.i(55486),h=a.i(68114);function i({tags:a,className:c,size:d="md"}){return 0===a.length?null:(0,b.jsx)("div",{className:(0,h.cn)("flex flex-wrap gap-2",c),children:a.map(a=>(0,b.jsx)(g.Badge,{variant:"info",size:d,children:a.name},a.id))})}let j={in_person:"In-Person",virtual:"Virtual",email:"Email",mixed:"Mixed"},k={last_6_months:"Last 6 months","6_12_months":"6-12 months ago","1_2_years":"1-2 years ago","2_plus_years":"2+ years ago"};function l({review:a,onAction:d,showReports:g}){let[h,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),q=Object.values(a.ratings).reduce((a,b)=>a+b,0)/Object.values(a.ratings).length;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Review for ",a.advisor.name]}),a.isVerified&&(0,b.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"✓ Verified Student"}),a.reportCount&&a.reportCount>0&&(0,b.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800",children:[a.reportCount," ",1===a.reportCount?"report":"reports"]})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[a.advisor.department," • ",a.advisor.university]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["Submitted: ",new Date(a.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),(0,b.jsx)(e.default,{href:`/a/${a.advisor.id}${a.advisor.slug?`/${a.advisor.slug}`:""}`,className:"text-sm text-[#5B2D8B] hover:text-[#4A2375] underline",target:"_blank",rel:"noopener noreferrer",children:"View Advisor Page →"})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Overall Rating:"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(a=>(0,b.jsx)("span",{className:`text-lg ${a<=Math.round(q)?"text-yellow-400":"text-gray-300"}`,children:"★"},a)),(0,b.jsxs)("span",{className:"ml-2 text-sm font-medium text-gray-700",children:[q.toFixed(1)," / 5.0"]})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-xs text-gray-600",children:Object.entries(a.ratings).map(([a,c])=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("span",{className:"capitalize",children:[a,":"]})," ",(0,b.jsxs)("span",{className:"font-medium",children:[c,"/5"]})]},a))})]}),(0,b.jsx)("div",{className:"mb-4 p-4 bg-gray-50 rounded-md",children:(0,b.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:a.text})}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-4",children:[(0,b.jsxs)("span",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Meeting:"})," ",j[a.meetingType]||a.meetingType]}),(0,b.jsxs)("span",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Timeframe:"})," ",k[a.timeframe]||a.timeframe]}),a.tags.length>0&&(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)(i,{tags:a.tags.map(a=>({id:a,name:a,slug:a.toLowerCase().replace(/\s+/g,"-")}))})})]}),(0,b.jsx)("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Button,{onClick:()=>{p(!0),d(a.id,"keep"),p(!1)},disabled:o,variant:"outline",size:"sm",children:"Keep Review"}),(0,b.jsx)(f.Button,{onClick:()=>l(!0),disabled:o,variant:"outline",size:"sm",className:"border-yellow-300 text-yellow-700 hover:bg-yellow-50",children:"Re-Review"}),(0,b.jsx)(f.Button,{onClick:()=>{confirm("Are you sure you want to remove this review? This action cannot be undone.")&&(p(!0),d(a.id,"remove"),p(!1))},disabled:o,size:"sm",className:"bg-red-600 hover:bg-red-700",children:"Remove Review"})]}):"pending"===a.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Button,{onClick:()=>{p(!0),d(a.id,"approve"),p(!1)},disabled:o,size:"sm",className:"bg-green-600 hover:bg-green-700",children:"Approve"}),(0,b.jsx)(f.Button,{onClick:()=>l(!0),disabled:o,variant:"outline",size:"sm",className:"border-red-300 text-red-700 hover:bg-red-50",children:"Reject"})]}):(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:["Status: ",(0,b.jsx)("span",{className:"font-medium capitalize",children:a.status})]})})]}),h&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Review"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this review. This reason is for internal use only and will not be shown to the user."}),(0,b.jsx)("textarea",{value:m,onChange:a=>n(a.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#A78BFA] mb-4"}),(0,b.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,b.jsx)(f.Button,{onClick:()=>{l(!1),n("")},variant:"outline",size:"sm",disabled:o,children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:()=>{m.trim()?(p(!0),d(a.id,"reject",m),l(!1),n(""),p(!1)):alert("Please provide a rejection reason")},size:"sm",className:"bg-red-600 hover:bg-red-700",disabled:o||!m.trim(),children:o?"Processing...":"Reject Review"})]})]})})]})}function m({size:a="md"}){return(0,b.jsx)("div",{className:"flex items-center justify-center",children:(0,b.jsx)("div",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[a]} border-4 border-violet-200 border-t-[#5B2D8B] rounded-full animate-spin`})})}function n({title:a,description:c,action:d}){return(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:a}),c&&(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:c}),d&&(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)("button",{onClick:d.onClick,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-[#5B2D8B] hover:bg-[#5B2D8B] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#A78BFA]",children:d.label})})]})}function o(){let[a,e]=(0,c.useState)("pending"),[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(""),o=async a=>{i(!0),k("");try{let b=await fetch(`/api/mod/reviews?status=${"reports"===a?"reported":a}&limit=50`),c=await b.json();if(!b.ok)throw Error(c.error||"Failed to fetch reviews");g(c.data?.reviews||[])}catch(a){k(a instanceof Error?a.message:"Failed to load reviews")}finally{i(!1)}};(0,c.useEffect)(()=>{o(a)},[a]);let p=async(b,c,d)=>{try{if("approve"===c){if(!(await fetch(`/api/mod/reviews/${b}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).ok)throw Error("Failed to approve review")}else if("reject"===c){if(!d)return void alert("Please provide a rejection reason");if(!(await fetch(`/api/mod/reviews/${b}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:d,notes:""})})).ok)throw Error("Failed to reject review")}else if("remove"===c){if(!(await fetch(`/api/mod/reviews/${b}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:"Removed due to reports",notes:""})})).ok)throw Error("Failed to remove review")}else if("keep"===c&&!(await fetch("/api/mod/reports/resolve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewId:b,action:"dismiss"})})).ok)throw Error("Failed to resolve reports");await o(a)}catch(a){alert(a instanceof Error?a.message:"Action failed")}};return(0,b.jsxs)("div",{children:[(0,b.jsx)(d,{activeTab:a,onTabChange:e}),h?(0,b.jsx)("div",{className:"flex justify-center py-12",children:(0,b.jsx)(m,{size:"lg"})}):j?(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,b.jsx)("p",{className:"text-red-800",children:j})}):0===f.length?(0,b.jsx)(n,{title:`No ${a} reviews`,description:"pending"===a?"All reviews have been moderated":"reports"===a?"No reported reviews":`No ${a} reviews found`}):(0,b.jsx)("div",{className:"space-y-4 mt-6",children:f.map(c=>(0,b.jsx)(l,{review:c,onAction:p,showReports:"reports"===a},c.id))})]})}a.s(["ModerationDashboard",()=>o],19973)}];

//# sourceMappingURL=src_components_moderation_ModerationDashboard_tsx_390d3c4a._.js.map